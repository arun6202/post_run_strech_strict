<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Elite Post-Run Stretch</title>
    <style>
        :root {
            --bg-dark: #0f172a;
            --surface: #1e293b;
            --primary-accent: #38bdf8; /* A bright sky blue */
            --primary-text: #f8fafc;
            --secondary-text: #94a3b8;
            --border-color: #334155;
            --shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
            --border-radius: 12px;
            --transition: all 0.3s ease-in-out;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
        }

        html, body {
            height: 100%;
        }
        
        body {
            font-family: 'Inter', 'Segoe UI', system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: var(--bg-dark);
            color: var(--primary-text);
            display: flex;
            flex-direction: column;
            user-select: none;
            -webkit-user-select: none;
            line-height: 1.6;
        }

        .header {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 1rem 1.5rem;
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border-color);
            position: sticky;
            top: 0;
            z-index: 1000;
            position: relative;
        }

        .header-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--primary-text);
        }

        .header-controls {
            position: absolute;
            right: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .header-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .test-btn {
            background-color: var(--primary-accent);
            color: var(--bg-dark);
            border: none;
            padding: 0.4rem 0.8rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.9rem;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .test-btn:hover {
            opacity: 0.9;
        }
        .test-btn:active {
            transform: scale(0.96);
        }
        
        .volume-display {
            font-size: 0.9rem;
            font-weight: 500;
            color: var(--secondary-text);
        }

        .main-container {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 2rem 1rem 8rem 1rem; /* Padding bottom for controls */
            gap: 1.5rem;
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
        }

        .top-info {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 2rem;
            flex-wrap: wrap;
            margin-bottom: 1rem;
        }
        
        .progress-container {
            position: relative;
            width: 100px;
            height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .progress-svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            transform: rotate(-90deg);
        }
        .progress-svg circle {
            fill: none;
            stroke-width: 8;
            stroke-linecap: round;
        }
        .progress-bg { stroke: var(--surface); }
        .progress-bar {
            stroke: var(--primary-accent);
            transition: stroke-dashoffset 1s linear;
        }
        
        .progress-text {
            text-align: center;
            font-weight: 700;
        }
        .progress-value {
            font-size: 1.75rem;
            color: var(--primary-text);
        }
        .progress-label {
            font-size: 0.7rem;
            color: var(--secondary-text);
            text-transform: uppercase;
            letter-spacing: 1.5px;
        }

        .time-summary {
            font-size: 0.9rem;
            color: var(--secondary-text);
            text-align: left;
            line-height: 1.8;
            min-width: 160px;
        }
        .time-summary strong {
            color: var(--primary-text);
            font-weight: 500;
            float: right;
            margin-left: 1rem;
        }

        .exercise-info h1 {
            font-size: clamp(1.5rem, 5vw, 2.25rem);
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .exercise-info h2 {
            font-size: clamp(1rem, 3vw, 1.25rem);
            font-weight: 400;
            color: var(--primary-accent);
            margin-bottom: 0.5rem;
            min-height: 1.25em;
        }

        .exercise-info p {
            color: var(--secondary-text);
            font-size: 0.9rem;
        }
        
        .exercise-timer {
            position: relative;
            width: 180px;
            height: 180px;
            margin: 1.5rem 0;
        }
        
        .exercise-timer .progress-value {
            font-size: 4rem;
        }
        .exercise-timer .progress-label {
            font-size: 1rem;
        }

        .exercise-meta {
            color: var(--secondary-text);
        }
        
        .details-toggle {
            color: var(--primary-accent);
            cursor: pointer;
            text-decoration: underline;
            margin-bottom: 0.5rem;
            display: inline-block;
            font-size: 0.9rem;
            padding: 0.25rem 0;
        }

        .details-toggle:hover {
            opacity: 0.8;
        }

        .exercise-details {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1rem;
            margin-top: 0.5rem;
            display: none;
            color: var(--secondary-text);
            font-size: 0.9rem;
            line-height: 1.6;
        }

        .exercise-details.visible {
            display: block;
            animation: fadeIn 0.3s ease-in;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .exercise-details h4 {
            color: var(--primary-text);
            margin-bottom: 0.5rem;
            font-size: 0.95rem;
        }

        .exercise-details p {
            margin-bottom: 0.75rem;
        }

        .exercise-details p:last-child {
            margin-bottom: 0;
        }

        #next-exercise-text {
            min-height: 1.2em;
        }

        .controls {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(10px);
            padding: 1.2rem;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 2rem;
            border-top: 1px solid var(--border-color);
            z-index: 1000;
        }

        .controls button {
            background: transparent;
            color: var(--primary-text);
            border: 2px solid var(--border-color);
            border-radius: 16px;
            width: 72px;
            height: 72px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0.5rem;
        }
        
        .controls button#playPauseBtn {
            width: 80px;
            height: 80px;
            background-color: var(--primary-accent);
            color: var(--bg-dark);
            border: none;
            border-radius: 20px;
        }
        
        .controls button:hover:not(:disabled) {
            background-color: var(--surface);
            border-color: var(--secondary-text);
            transform: translateY(-2px);
        }
        .controls button#playPauseBtn:hover:not(:disabled) {
            background-color: var(--primary-accent);
            opacity: 0.9;
            transform: translateY(-2px) scale(1.05);
        }

        .controls button:active:not(:disabled) {
            transform: scale(0.95);
        }

        .controls button:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }
        
        .complete-screen {
            padding: 2rem;
        }
        .complete-screen h2 {
            font-size: 2.5rem;
            color: #4ade80; /* A nice green */
            margin-bottom: 1rem;
        }

        .btn-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
            gap: 0.2rem;
            text-align: center;
        }
        
        .btn-label {
            font-size: 0.75rem;
            font-weight: 500;
            line-height: 1;
            white-space: nowrap;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .material-symbols-outlined {
            font-size: 1.8rem;
            line-height: 1;
            font-variation-settings: 'FILL' 1, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }
        
        .controls button#playPauseBtn .material-symbols-outlined {
            font-size: 2.2rem;
        }
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <!-- Add Material Symbols font -->
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" rel="stylesheet">
</head>
<body>
    <header class="header">
        <div class="header-title">Elite Post-Run Stretch</div>
        <div class="header-controls">
            <button class="test-btn" onclick="testAudio()">ðŸ”Š Test</button>
            <span id="volumeDisplay" class="volume-display">90%</span>
        </div>
    </header>

    <main class="main-container" id="app-view">
        <!-- JS will populate this view -->
    </main>
    
    <div class="controls">
        <button onclick="previousExercise()" id="prevBtn" disabled aria-label="Previous Exercise">
            <span class="btn-content">
                <span class="material-symbols-outlined">skip_previous</span>
                <span class="btn-label">Prev</span>
            </span>
        </button>
        <button onclick="togglePlayPause()" id="playPauseBtn" aria-label="Play/Pause">
            <span class="btn-content">
                <span class="material-symbols-outlined" id="playPauseIcon">play_arrow</span>
                <span class="btn-label" id="playPauseLabel">Play</span>
            </span>
        </button>
        <button onclick="skipExercise()" id="skipBtn" disabled aria-label="Skip Exercise">
            <span class="btn-content">
                <span class="material-symbols-outlined">skip_next</span>
                <span class="btn-label">Next</span>
            </span>
        </button>
    </div>

    <script>
    const routine = [
  {
    "type": "note",
    "name": "WORKOUT START",
    "details": "Welcome to your hour-long isometric workout! This at-home routine targets your entire body. Remember, isometrics means holding a muscle contraction without lengthening or shortening. You'll need a mat or elbow-friendly surface, water, and a towel. Each position is held for 40 seconds, with 20 seconds to get ready for the next.",
    "duration": 60,
    "voice": "Welcome to your hour-long isometric workout. Get ready to target your entire body!"
  },
  {
    "type": "note",
    "name": "REMINDERS",
    "details": "Remember to relax your breathing when holding the contraction and only work to your ability. For any hold involving leg lower, simply do not lower as much. For push-ups, perform them on your knees if needed.",
    "duration": 5,
    "voice": "Quick reminder: relax your breathing, and work at your own pace. Modify as needed."
  },
  {
    "type": "note",
    "name": "STARTING SECTION: ABS & CORE",
    "details": "First up, 10 minutes of intense core work!",
    "duration": 0,
    "voice": "Let's kick things off with 10 minutes of abs and core."
  },
  {
    "name": "CRUNCH",
    "details": "Lie on your back, knees bent, feet flat. Place hands behind your head or crossed on your chest. Engage your abs to lift your head and shoulders off the mat, focusing on contracting your core. Hold at the top.",
    "duration": 40,
    "affected": "Abs, Core",
    "dos": "Keep neck relaxed, focus on core engagement.",
    "donts": "Don't pull on your neck. Don't lift too high.",
    "info": "Classic core engagement."
  },
  {
    "name": "SIT UP",
    "details": "Lie on your back, knees bent, feet flat. Place hands behind your head or crossed on your chest. Engage your core to lift your entire torso off the mat, coming towards your knees. Hold at the top or midway.",
    "duration": 40,
    "affected": "Abs, Core",
    "dos": "Use your core, not momentum. Control the movement.",
    "donts": "Don't yank your neck or use momentum.",
    "info": "Full range core activation."
  },
  {
    "name": "HOLLOW HOLD",
    "details": "Lie on your back. Lift your head, shoulders, and legs slightly off the floor. Keep your lower back pressed into the mat. Extend arms overhead or by your sides.",
    "duration": 40,
    "affected": "Abs, Deep Core",
    "dos": "Keep lower back glued to the floor. Engage deep core.",
    "donts": "Don't let your lower back arch off the floor.",
    "info": "Excellent for deep core strength and stability."
  },
  {
    "name": "V SIT HOLD",
    "details": "Sit on your tailbone, leaning back slightly. Lift your legs and torso to form a 'V' shape. Keep your core tight and maintain balance. Arms can be extended forward or to the sides.",
    "duration": 40,
    "affected": "Abs, Obliques, Hip Flexors",
    "dos": "Keep core engaged, balance on tailbone.",
    "donts": "Don't round your back. Don't let legs drop.",
    "info": "Challenges balance and upper/lower ab strength."
  },
  {
    "name": "BICYCLE CRUNCH HOLD (Right Side)",
    "details": "Lie on your back, hands behind head. Bring right elbow towards left knee while extending right leg. Hold the contraction.",
    "duration": 40,
    "affected": "Obliques, Abs",
    "dos": "Twist from the core, keep opposite shoulder off floor.",
    "donts": "Don't pull on your neck. Don't rush.",
    "info": "Targets the obliques."
  },
  {
    "name": "BICYCLE CRUNCH HOLD (Left Side)",
    "details": "Lie on your back, hands behind head. Bring left elbow towards right knee while extending left leg. Hold the contraction.",
    "duration": 40,
    "affected": "Obliques, Abs",
    "dos": "Twist from the core, keep opposite shoulder off floor.",
    "donts": "Don't pull on your neck. Don't rush.",
    "info": "Targets the obliques."
  },
  {
    "name": "SIDE PLANK (Right Side)",
    "details": "Prop yourself up on your right forearm and the side of your right foot. Keep your body in a straight line from head to heels. Stack your feet or place one in front of the other. Left arm can be extended upwards or on your hip.",
    "duration": 40,
    "affected": "Obliques, Core, Shoulders",
    "dos": "Keep hips lifted, body straight. Engage core.",
    "donts": "Don't let your hips sag. Don't hunch your shoulders.",
    "info": "Strengthens side core and stability."
  },
  {
    "name": "SIDE PLANK (Left Side)",
    "details": "Prop yourself up on your left forearm and the side of your left foot. Keep your body in a straight line from head to heels. Stack your feet or place one in front of the other. Right arm can be extended upwards or on your hip.",
    "duration": 40,
    "affected": "Obliques, Core, Shoulders",
    "dos": "Keep hips lifted, body straight. Engage core.",
    "donts": "Don't let your hips sag. Don't hunch your shoulders.",
    "info": "Strengthens side core and stability."
  },
  {
    "name": "LONG PLANK HOLD",
    "details": "Start in a standard plank position on your forearms and toes. Extend your arms further forward, so your elbows are in front of your shoulders. Maintain a straight line from head to heels.",
    "duration": 40,
    "affected": "Entire Core, Shoulders, Back",
    "dos": "Keep body straight, engage glutes and abs. Don't let hips sag.",
    "donts": "Don't arch your back or let your hips drop.",
    "info": "Increased challenge to standard plank."
  },
  {
    "name": "BEAR CRAWL HOVER",
    "details": "Start on all fours, hands directly under shoulders, knees under hips. Lift your knees about an inch off the ground, keeping your back flat. Hold this hovered position.",
    "duration": 40,
    "affected": "Core, Shoulders, Quads",
    "dos": "Keep back flat, core tight. Breathe.",
    "donts": "Don't let your hips rise too high or sag.",
    "info": "Great for full-body stability and core strength."
  },
  {
    "type": "note",
    "name": "STARTING SECTION: UPPER BODY",
    "details": "Now, 10 minutes dedicated to your upper body!",
    "duration": 0,
    "voice": "Moving on to 10 minutes of upper body work."
  },
  {
    "name": "PUSH UP HOLD",
    "details": "Get into a push-up position, hands slightly wider than shoulder-width. Lower your chest towards the floor until your elbows are at about a 90-degree angle. Hold this lowered position. Modify by dropping to your knees if needed.",
    "duration": 40,
    "affected": "Chest, Shoulders, Triceps, Core",
    "dos": "Keep body straight, engage core. Control the descent.",
    "donts": "Don't let your hips sag or rise too high.",
    "info": "Classic upper body strength builder."
  },
  {
    "name": "TRICEP PUSH UP HOLD",
    "details": "Get into a push-up position with hands directly under your shoulders, elbows tucked in close to your body. Lower your chest towards the floor, keeping elbows narrow. Hold this lowered position. Modify by dropping to your knees if needed.",
    "duration": 40,
    "affected": "Triceps, Chest, Shoulders",
    "dos": "Keep elbows close to body. Engage triceps.",
    "donts": "Don't let elbows flare out. Don't hunch shoulders.",
    "info": "Specifically targets the triceps."
  },
  {
    "name": "SUPERMAN HOLD (Palms Facing Down)",
    "details": "Lie face down on your mat with arms extended forward and palms facing down. Lift your chest, arms, and legs off the floor simultaneously, engaging your back muscles. Hold at the top.",
    "duration": 40,
    "affected": "Lower Back, Glutes, Hamstrings, Shoulders",
    "dos": "Engage glutes and back. Look down to keep neck neutral.",
    "donts": "Don't strain your neck. Don't use momentum.",
    "info": "Strengthens the posterior chain."
  },
  {
    "name": "REVERSE FLY HOLD (Palms Facing Away)",
    "details": "Lie face down with arms extended to your sides, palms facing away from each other. Lift your chest and arms off the floor, squeezing your shoulder blades together. Hold at the top.",
    "duration": 40,
    "affected": "Upper Back, Shoulders (Rear Deltoids)",
    "dos": "Squeeze shoulder blades. Keep neck neutral.",
    "donts": "Don't arch your lower back excessively.",
    "info": "Targets the muscles between shoulder blades."
  },
  {
    "name": "DIPS HOLD",
    "details": "Sit on the edge of a sturdy chair or bench, hands gripping the edge beside your hips, fingers pointing forward. Slide your hips off the chair, bending elbows to 90 degrees. Keep your back close to the chair. Hold this lowered position.",
    "duration": 40,
    "affected": "Triceps, Shoulders, Chest",
    "dos": "Keep chest open, elbows pointing back. Go to 90 degrees.",
    "donts": "Don't let shoulders hunch up to your ears. Don't go too deep.",
    "info": "Excellent for tricep strength."
  },
  {
    "name": "UPRIGHT SIDE PLANK (Right Side)",
    "details": "Similar to a side plank, but with the supporting arm straight, hand on the floor directly under your shoulder. Maintain a straight line from head to heels. Stack feet or place one in front of the other.",
    "duration": 40,
    "affected": "Obliques, Shoulders, Core",
    "dos": "Keep body straight, hips lifted. Engage core.",
    "donts": "Don't let your hips sag. Don't lock your elbow.",
    "info": "Higher intensity side core work."
  },
  {
    "name": "UPRIGHT SIDE PLANK (Left Side)",
    "details": "Similar to a side plank, but with the supporting arm straight, hand on the floor directly under your shoulder. Maintain a straight line from head to heels. Stack feet or place one in front of the other.",
    "duration": 40,
    "affected": "Obliques, Shoulders, Core",
    "dos": "Keep body straight, hips lifted. Engage core.",
    "donts": "Don't let your hips sag. Don't lock your elbow.",
    "info": "Higher intensity side core work."
  },
  {
    "name": "PIKE HOLD",
    "details": "Start in a plank position, then walk your hands back towards your feet, lifting your hips high into an inverted 'V' shape. Keep your back straight and legs as straight as possible. Hold this position.",
    "duration": 40,
    "affected": "Hamstrings, Shoulders, Core",
    "dos": "Keep back straight, engage core. Stretch hamstrings.",
    "donts": "Don't round your back excessively. Don't lock knees.",
    "info": "Stretches hamstrings and strengthens shoulders."
  },
  {
    "name": "PIKE PUSH UP HOLD",
    "details": "From a pike position, bend your elbows, lowering the crown of your head towards the floor. Keep your hips high. Hold in the lowered position. Modify depth as needed.",
    "duration": 40,
    "affected": "Shoulders (Deltoids), Triceps",
    "dos": "Keep elbows pointing back. Focus on shoulder engagement.",
    "donts": "Don't strain your neck. Don't let hips sag.",
    "info": "Advanced shoulder strength, preps for handstands."
  },
  {
    "name": "WIDE PUSH UP HOLD",
    "details": "Get into a push-up position with hands significantly wider than shoulder-width. Lower your chest towards the floor until your elbows are at about a 90-degree angle. Hold this lowered position. Modify by dropping to your knees if needed.",
    "duration": 40,
    "affected": "Chest (Outer), Shoulders, Triceps",
    "dos": "Keep body straight, engage core. Control the descent.",
    "donts": "Don't let your hips sag or rise too high.",
    "info": "Emphasizes outer chest muscles."
  },
  {
    "type": "note",
    "name": "STARTING SECTION: LOWER BODY",
    "details": "Time for 20 minutes of powerful lower body exercises!",
    "duration": 0,
    "voice": "Let's move into 20 minutes of lower body exercises."
  },
  {
    "name": "SQUAT HOLD",
    "details": "Stand with feet shoulder-width apart, toes slightly out. Lower your hips as if sitting into a chair, keeping your chest up and back straight. Aim for thighs parallel to the floor. Hold at the bottom.",
    "duration": 40,
    "affected": "Quads, Glutes, Hamstrings, Core",
    "dos": "Keep chest up, knees over toes, weight in heels.",
    "donts": "Don't round your back. Don't let knees cave in.",
    "info": "Foundational lower body strength."
  },
  {
    "name": "CLOSE STANCE SQUAT ON TOES HOLD",
    "details": "Stand with feet hip-width apart, or slightly closer. Rise up onto your toes, then lower into a squat, keeping your balance. Hold at the bottom.",
    "duration": 40,
    "affected": "Quads, Calves, Glutes, Balance",
    "dos": "Keep balance, focus on calf and quad engagement.",
    "donts": "Don't let heels drop. Don't lose balance.",
    "info": "Challenges balance and calf strength."
  },
  {
    "name": "SUMO SQUAT HOLD",
    "details": "Stand with feet wide, toes pointing outwards (45 degrees). Lower your hips, keeping your chest up and back straight. Focus on inner thigh engagement. Hold at the bottom.",
    "duration": 40,
    "affected": "Inner Thighs (Adductors), Glutes, Quads",
    "dos": "Keep chest up, knees tracking over toes. Go deep.",
    "donts": "Don't let knees cave inwards. Don't round your back.",
    "info": "Targets inner thighs and glutes."
  },
  {
    "name": "X-OVER SQUAT HOLD (Right Leg Back)",
    "details": "Step your right leg back and across behind your left leg, as if doing a curtsy. Lower into a squat, keeping your chest up and back straight. Hold at the bottom.",
    "duration": 40,
    "affected": "Glutes (especially outer), Quads, Adductors",
    "dos": "Keep chest up, knee over ankle of front leg.",
    "donts": "Don't let front knee cave in.",
    "info": "Targets outer glutes and improves hip mobility."
  },
  {
    "name": "X-OVER SQUAT HOLD (Left Leg Back)",
    "details": "Step your left leg back and across behind your right leg, as if doing a curtsy. Lower into a squat, keeping your chest up and back straight. Hold at the bottom.",
    "duration": 40,
    "affected": "Glutes (especially outer), Quads, Adductors",
    "dos": "Keep chest up, knee over ankle of front leg.",
    "donts": "Don't let front knee cave in.",
    "info": "Targets outer glutes and improves hip mobility."
  },
  {
    "name": "LUNGE ON TOES HOLD (Right Leg Forward)",
    "details": "Step right leg forward and rise onto the toes of both feet. Lower into a lunge, aiming for both knees at 90 degrees. Keep chest up. Hold at the bottom.",
    "duration": 40,
    "affected": "Quads, Glutes, Calves, Balance",
    "dos": "Keep balance, core engaged. Knees at 90 degrees.",
    "donts": "Don't let front knee go past toes. Don't lose balance.",
    "info": "Increases calf and quad engagement."
  },
  {
    "name": "LUNGE ON TOES HOLD (Left Leg Forward)",
    "details": "Step left leg forward and rise onto the toes of both feet. Lower into a lunge, aiming for both knees at 90 degrees. Keep chest up. Hold at the bottom.",
    "duration": 40,
    "affected": "Quads, Glutes, Calves, Balance",
    "dos": "Keep balance, core engaged. Knees at 90 degrees.",
    "donts": "Don't let front knee go past toes. Don't lose balance.",
    "info": "Increases calf and quad engagement."
  },
  {
    "name": "CURTSEY LUNGE HOLD (Right Leg Back)",
    "details": "Stand tall. Step your right foot behind and across your left leg, bending both knees as if doing a curtsy. Keep your torso upright. Hold at the bottom.",
    "duration": 40,
    "affected": "Glutes (Outer), Quads, Hips",
    "dos": "Keep chest up, control movement. Feel the outer glute.",
    "donts": "Don't lean too much. Don't let front knee cave in.",
    "info": "Targets the outer gluteal muscles."
  },
  {
    "name": "CURTSEY LUNGE HOLD (Left Leg Back)",
    "details": "Stand tall. Step your left foot behind and across your right leg, bending both knees as if doing a curtsy. Keep your torso upright. Hold at the bottom.",
    "duration": 40,
    "affected": "Glutes (Outer), Quads, Hips",
    "dos": "Keep chest up, control movement. Feel the outer glute.",
    "donts": "Don't lean too much. Don't let front knee cave in.",
    "info": "Targets the outer gluteal muscles."
  },
  {
    "name": "LATERAL LUNGE HOLD (Right Side)",
    "details": "Step your right foot out to the side, keeping your left leg straight. Bend your right knee, pushing hips back, keeping chest up. Hold at the bottom.",
    "duration": 40,
    "affected": "Inner Thighs (Adductors), Glutes, Quads",
    "dos": "Keep chest up, straight back. Push hips back.",
    "donts": "Don't let knee go past toes. Don't round back.",
    "info": "Works inner and outer thighs."
  },
  {
    "name": "LATERAL LUNGE HOLD (Left Side)",
    "details": "Step your left foot out to the side, keeping your right leg straight. Bend your left knee, pushing hips back, keeping chest up. Hold at the bottom.",
    "duration": 40,
    "affected": "Inner Thighs (Adductors), Glutes, Quads",
    "dos": "Keep chest up, straight back. Push hips back.",
    "donts": "Don't let knee go past toes. Don't round back.",
    "info": "Works inner and outer thighs."
  },
  {
    "name": "LEG EXTENSION HOLD (Right Leg)",
    "details": "Sit on a chair or bench. Extend your right leg straight out in front of you, flexing your quadriceps. Hold the leg elevated and straight.",
    "duration": 40,
    "affected": "Quads",
    "dos": "Keep leg straight, quad engaged. Avoid swinging.",
    "donts": "Don't let leg drop. Don't use momentum.",
    "info": "Isolates the quadriceps."
  },
  {
    "name": "LEG EXTENSION HOLD (Left Leg)",
    "details": "Sit on a chair or bench. Extend your left leg straight out in front of you, flexing your quadriceps. Hold the leg elevated and straight.",
    "duration": 40,
    "affected": "Quads",
    "dos": "Keep leg straight, quad engaged. Avoid swinging.",
    "donts": "Don't let leg drop. Don't use momentum.",
    "info": "Isolates the quadriceps."
  },
  {
    "name": "SIDE LEG RAISE HOLD (Right Leg)",
    "details": "Lie on your left side, legs straight. Keep your body in a straight line. Lift your right leg straight up towards the ceiling, leading with the heel. Hold at the top.",
    "duration": 40,
    "affected": "Outer Thighs (Abductors), Glutes",
    "dos": "Keep body straight, engage glutes. Control movement.",
    "donts": "Don't let leg swing forward or back. Don't arch back.",
    "info": "Strengthens hip abductors."
  },
  {
    "name": "SIDE LEG RAISE HOLD (Left Leg)",
    "details": "Lie on your right side, legs straight. Keep your body in a straight line. Lift your left leg straight up towards the ceiling, leading with the heel. Hold at the top.",
    "duration": 40,
    "affected": "Outer Thighs (Abductors), Glutes",
    "dos": "Keep body straight, engage glutes. Control movement.",
    "donts": "Don't let leg swing forward or back. Don't arch back.",
    "info": "Strengthens hip abductors."
  },
  {
    "name": "STANDING LEG CURL HOLD (Right Leg)",
    "details": "Stand tall, optionally holding onto a support. Bend your right knee, bringing your heel towards your glute, flexing your hamstring. Hold the contraction.",
    "duration": 40,
    "affected": "Hamstrings, Glutes",
    "dos": "Squeeze hamstring. Keep hips stable.",
    "donts": "Don't arch your back. Don't let knee fall forward.",
    "info": "Isolates the hamstrings."
  },
  {
    "name": "STANDING LEG CURL HOLD (Left Leg)",
    "details": "Stand tall, optionally holding onto a support. Bend your left knee, bringing your heel towards your glute, flexing your hamstring. Hold the contraction.",
    "duration": 40,
    "affected": "Hamstrings, Glutes",
    "dos": "Squeeze hamstring. Keep hips stable.",
    "donts": "Don't arch your back. Don't let knee fall forward.",
    "info": "Isolates the hamstrings."
  },
  {
    "name": "SINGLE LEG GLUTE BRIDGE HOLD (Right Leg)",
    "details": "Lie on your back, left knee bent, foot flat. Extend your right leg straight. Lift your hips off the floor, forming a straight line from shoulder to left knee to extended right leg. Squeeze your glutes. Hold at the top.",
    "duration": 40,
    "affected": "Glutes, Hamstrings, Core",
    "dos": "Squeeze glutes, keep hips level. Push through heel.",
    "donts": "Don't let hips sag. Don't arch lower back.",
    "info": "Excellent for unilateral glute strength."
  },
  {
    "name": "SINGLE LEG GLUTE BRIDGE HOLD (Left Leg)",
    "details": "Lie on your back, right knee bent, foot flat. Extend your left leg straight. Lift your hips off the floor, forming a straight line from shoulder to right knee to extended left leg. Squeeze your glutes. Hold at the top.",
    "duration": 40,
    "affected": "Glutes, Hamstrings, Core",
    "dos": "Squeeze glutes, keep hips level. Push through heel.",
    "donts": "Don't let hips sag. Don't arch lower back.",
    "info": "Excellent for unilateral glute strength."
  },
  {
    "name": "HAMSTRING WALK OUT HOLD",
    "details": "Lie on your back, knees bent, feet flat. Lift your hips into a glute bridge. Slowly walk your feet forward, one small step at a time, keeping your hips elevated. Hold the farthest comfortable position.",
    "duration": 40,
    "affected": "Hamstrings, Glutes, Core",
    "dos": "Keep hips lifted, engage hamstrings. Move slowly.",
    "donts": "Don't let hips drop. Don't arch lower back.",
    "info": "Intense hamstring engagement."
  },
  {
    "type": "note",
    "name": "REPEATING SECTION: UPPER BODY",
    "details": "Another 10 minutes for the upper body, similar to before but without the side planks!",
    "duration": 0,
    "voice": "Back to upper body for another 10 minutes. No side planks this time."
  },
  {
    "name": "PUSH UP HOLD",
    "details": "Get into a push-up position, hands slightly wider than shoulder-width. Lower your chest towards the floor until your elbows are at about a 90-degree angle. Hold this lowered position. Modify by dropping to your knees if needed.",
    "duration": 40,
    "affected": "Chest, Shoulders, Triceps, Core",
    "dos": "Keep body straight, engage core. Control the descent.",
    "donts": "Don't let your hips sag or rise too high.",
    "info": "Classic upper body strength builder."
  },
  {
    "name": "TRICEP PUSH UP HOLD",
    "details": "Get into a push-up position with hands directly under your shoulders, elbows tucked in close to your body. Lower your chest towards the floor, keeping elbows narrow. Hold this lowered position. Modify by dropping to your knees if needed.",
    "duration": 40,
    "affected": "Triceps, Chest, Shoulders",
    "dos": "Keep elbows close to body. Engage triceps.",
    "donts": "Don't let elbows flare out. Don't hunch shoulders.",
    "info": "Specifically targets the triceps."
  },
  {
    "name": "SUPERMAN HOLD (Palms Facing Down)",
    "details": "Lie face down on your mat with arms extended forward and palms facing down. Lift your chest, arms, and legs slightly off the floor simultaneously, engaging your back muscles. Hold at the top.",
    "duration": 40,
    "affected": "Lower Back, Glutes, Hamstrings, Shoulders",
    "dos": "Engage glutes and back. Look down to keep neck neutral.",
    "donts": "Don't strain your neck. Don't use momentum.",
    "info": "Strengthens the posterior chain."
  },
  {
    "name": "REVERSE FLY HOLD (Palms Facing Away)",
    "details": "Lie face down with arms extended to your sides, palms facing away from each other. Lift your chest and arms off the floor, squeezing your shoulder blades together. Hold at the top.",
    "duration": 40,
    "affected": "Upper Back, Shoulders (Rear Deltoids)",
    "dos": "Squeeze shoulder blades. Keep neck neutral.",
    "donts": "Don't arch your lower back excessively.",
    "info": "Targets the muscles between shoulder blades."
  },
  {
    "name": "DIPS HOLD",
    "details": "Sit on the edge of a sturdy chair or bench, hands gripping the edge beside your hips, fingers pointing forward. Slide your hips off the chair, bending elbows to 90 degrees. Keep your back close to the chair. Hold this lowered position.",
    "duration": 40,
    "affected": "Triceps, Shoulders, Chest",
    "dos": "Keep chest open, elbows pointing back. Go to 90 degrees.",
    "donts": "Don't let shoulders hunch up to your ears. Don't go too deep.",
    "info": "Excellent for tricep strength."
  },
  {
    "name": "PIKE HOLD",
    "details": "Start in a plank position, then walk your hands back towards your feet, lifting your hips high into an inverted 'V' shape. Keep your back straight and legs as straight as possible. Hold this position.",
    "duration": 40,
    "affected": "Hamstrings, Shoulders, Core",
    "dos": "Keep back straight, engage core. Stretch hamstrings.",
    "donts": "Don't round your back excessively. Don't lock knees.",
    "info": "Stretches hamstrings and strengthens shoulders."
  },
  {
    "name": "PIKE PUSH UP HOLD",
    "details": "From a pike position, bend your elbows, lowering the crown of your head towards the floor. Keep your hips high. Hold in the lowered position. Modify depth as needed.",
    "duration": 40,
    "affected": "Shoulders (Deltoids), Triceps",
    "dos": "Keep elbows pointing back. Focus on shoulder engagement.",
    "donts": "Don't strain your neck. Don't let hips sag.",
    "info": "Advanced shoulder strength, preps for handstands."
  },
  {
    "name": "WIDE PUSH UP HOLD",
    "details": "Get into a push-up position with hands significantly wider than shoulder-width. Lower your chest towards the floor until your elbows are at about a 90-degree angle. Hold this lowered position. Modify by dropping to your knees if needed.",
    "duration": 40,
    "affected": "Chest (Outer), Shoulders, Triceps",
    "dos": "Keep body straight, engage core. Control the descent.",
    "donts": "Don't let your hips sag or rise too high.",
    "info": "Emphasizes outer chest muscles."
  },
  {
    "type": "note",
    "name": "FINAL SECTION: ABS & CORE",
    "details": "Finishing strong with another 10 minutes of core work!",
    "duration": 0,
    "voice": "Alright, last section! Let's hit the abs and core again."
  },
  {
    "name": "CRUNCH",
    "details": "Lie on your back, knees bent, feet flat. Place hands behind your head or crossed on your chest. Engage your abs to lift your head and shoulders off the mat, focusing on contracting your core. Hold at the top.",
    "duration": 40,
    "affected": "Abs, Core",
    "dos": "Keep neck relaxed, focus on core engagement.",
    "donts": "Don't pull on your neck. Don't lift too high.",
    "info": "Classic core engagement."
  },
  {
    "name": "SIT UP",
    "details": "Lie on your back, knees bent, feet flat. Place hands behind your head or crossed on your chest. Engage your core to lift your entire torso off the mat, coming towards your knees. Hold at the top or midway.",
    "duration": 40,
    "affected": "Abs, Core",
    "dos": "Use your core, not momentum. Control the movement.",
    "donts": "Don't yank your neck or use momentum.",
    "info": "Full range core activation."
  },
  {
    "name": "HOLLOW HOLD",
    "details": "Lie on your back. Lift your head, shoulders, and legs slightly off the floor. Keep your lower back pressed into the mat. Extend arms overhead or by your sides.",
    "duration": 40,
    "affected": "Abs, Deep Core",
    "dos": "Keep lower back glued to the floor. Engage deep core.",
    "donts": "Don't let your lower back arch off the floor.",
    "info": "Excellent for deep core strength and stability."
  },
  {
    "name": "V SIT HOLD",
    "details": "Sit on your tailbone, leaning back slightly. Lift your legs and torso to form a 'V' shape. Keep your core tight and maintain balance. Arms can be extended forward or to the sides.",
    "duration": 40,
    "affected": "Abs, Obliques, Hip Flexors",
    "dos": "Keep core engaged, balance on tailbone.",
    "donts": "Don't round your back. Don't let legs drop.",
    "info": "Challenges balance and upper/lower ab strength."
  },
  {
    "name": "BICYCLE CRUNCH HOLD (Right Side)",
    "details": "Lie on your back, hands behind head. Bring right elbow towards left knee while extending right leg. Hold the contraction.",
    "duration": 40,
    "affected": "Obliques, Abs",
    "dos": "Twist from the core, keep opposite shoulder off floor.",
    "donts": "Don't pull on your neck. Don't rush.",
    "info": "Targets the obliques."
  },
  {
    "name": "BICYCLE CRUNCH HOLD (Left Side)",
    "details": "Lie on your back, hands behind head. Bring left elbow towards right knee while extending left leg. Hold the contraction.",
    "duration": 40,
    "affected": "Obliques, Abs",
    "dos": "Twist from the core, keep opposite shoulder off floor.",
    "donts": "Don't pull on your neck. Don't rush.",
    "info": "Targets the obliques."
  },
  {
    "name": "SIDE PLANK (Right Side)",
    "details": "Prop yourself up on your right forearm and the side of your right foot. Keep your body in a straight line from head to heels. Stack your feet or place one in front of the other. Left arm can be extended upwards or on your hip.",
    "duration": 40,
    "affected": "Obliques, Core, Shoulders",
    "dos": "Keep hips lifted, body straight. Engage core.",
    "donts": "Don't let your hips sag. Don't hunch your shoulders.",
    "info": "Strengthens side core and stability."
  },
  {
    "name": "SIDE PLANK (Left Side)",
    "details": "Prop yourself up on your left forearm and the side of your left foot. Keep your body in a straight line from head to heels. Stack your feet or place one in front of the other. Right arm can be extended upwards or on your hip.",
    "duration": 40,
    "affected": "Obliques, Core, Shoulders",
    "dos": "Keep hips lifted, body straight. Engage core.",
    "donts": "Don't let your hips sag. Don't hunch your shoulders.",
    "info": "Strengthens side core and stability."
  },
  {
    "name": "LONG PLANK HOLD",
    "details": "Start in a standard plank position on your forearms and toes. Extend your arms further forward, so your elbows are in front of your shoulders. Maintain a straight line from head to heels.",
    "duration": 40,
    "affected": "Entire Core, Shoulders, Back",
    "dos": "Keep body straight, engage glutes and abs. Don't let hips sag.",
    "donts": "Don't arch your back or let your hips drop.",
    "info": "Increased challenge to standard plank."
  },
  {
    "name": "BEAR CRAWL HOVER",
    "details": "Start on all fours, hands directly under shoulders, knees under hips. Lift your knees about an inch off the ground, keeping your back flat. Hold this hovered position.",
    "duration": 40,
    "affected": "Core, Shoulders, Quads",
    "dos": "Keep back flat, core tight. Breathe.",
    "donts": "Don't let your hips rise too high or sag.",
    "info": "Great for full-body stability and core strength."
  },
  {
    "type": "note",
    "name": "WORKOUT COMPLETE",
    "details": "You've completed your isometric full-body workout! Great job holding those contractions and building strength. Remember to cool down and rehydrate.",
    "duration": 5,
    "voice": "Workout complete! You did a fantastic job. Remember to cool down and rehydrate."
  }
];

    // Global state
    let currentExerciseIndex = 0;
    let exerciseTimer;
    let timeSpentInCurrent = 0;
    let isPlaying = false;
    let isPaused = false;
    const synth = window.speechSynthesis;
    
    // UI Elements
    const appView = document.getElementById('app-view');
    const playPauseBtn = document.getElementById('playPauseBtn');
    const prevBtn = document.getElementById('prevBtn');
    const skipBtn = document.getElementById('skipBtn');

    // Utility Functions
    const formatTime = (seconds) => {
        const mins = Math.floor(seconds / 60);
        const secs = Math.round(seconds % 60);
        return `${mins}:${secs.toString().padStart(2, '0')}`;
    };

    const calculateTotalTime = () => routine.reduce((total, item) => total + (item.duration || 0), 0);

    // Speech Synthesis
    const speak = (text) => {
        if (!text) return;
        if (synth.speaking) synth.cancel();
        setTimeout(() => {
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.volume = 0.9;
            utterance.rate = 0.95;
            synth.speak(utterance);
        }, 150);
    };

    const testAudio = () => speak("Audio test successful.");
    
    // Progress Circle Updater
    const updateCircularProgress = (circleElement, percentage) => {
        if (!circleElement) return;
        const radius = circleElement.r.baseVal.value;
        const circumference = 2 * Math.PI * radius;
        const offset = circumference - (percentage / 100) * circumference;
        circleElement.style.strokeDasharray = `${circumference} ${circumference}`;
        circleElement.style.strokeDashoffset = offset;
    };

    // Main Display Logic
    const displayExercise = (index) => {
        if (index >= routine.length) {
            completeRoutine();
            return;
        }
        
        const item = routine[index];
        const isBreak = item.type === 'break';
        const isNote = item.type === 'note';
        
        let name = item.name;
        let subtitle = '';
        const subtitleMatch = name.match(/\(([^)]+)\)/);
        if (subtitleMatch) {
            subtitle = subtitleMatch[0];
            name = name.replace(subtitleMatch[0], '').trim();
        }

        const nextItem = index + 1 < routine.length ? routine[index + 1] : null;

        // Create details content if available
        let detailsContent = '';
        if (item.details || item.affected || item.dos || item.donts || item.info) {
            detailsContent = `
                <div class="exercise-details" id="exercise-details">
                    ${item.details ? `<h4>Instructions:</h4><p>${item.details}</p>` : ''}
                    ${item.affected ? `<h4>Muscles Affected:</h4><p>${item.affected}</p>` : ''}
                    ${item.dos ? `<h4>Do's:</h4><p>${item.dos}</p>` : ''}
                    ${item.donts ? `<h4>Don'ts:</h4><p>${item.donts}</p>` : ''}
                    ${item.info ? `<h4>Benefits:</h4><p>${item.info}</p>` : ''}
                </div>
            `;
        }

        appView.innerHTML = `
            <div class="top-info">
                <div class="progress-container">
                    <svg class="progress-svg" viewBox="0 0 100 100">
                        <circle class="progress-bg" cx="50" cy="50" r="45"></circle>
                        <circle class="progress-bar" id="overall-progress-bar" cx="50" cy="50" r="45"></circle>
                    </svg>
                    <div class="progress-text">
                        <span class="progress-value" id="overall-progress-value">0%</span>
                        <div class="progress-label">Overall</div>
                    </div>
                </div>
                <div class="time-summary">
                    <div>Total Time Spent<strong id="total-time-spent">0:00</strong></div>
                    <div>Total Time Left<strong id="total-time-left">0:00</strong></div>
                </div>
            </div>

            <div class="exercise-info">
                <h1>${name}</h1>
                <h2>${subtitle}</h2>
                <p>${(isBreak || isNote) ? '' : `Duration: ${item.duration} seconds`}</p>
            </div>
            
            <div class="exercise-timer progress-container">
                 <svg class="progress-svg" viewBox="0 0 100 100">
                    <circle class="progress-bg" cx="50" cy="50" r="45"></circle>
                    <circle class="progress-bar" id="exercise-progress-bar" cx="50" cy="50" r="45"></circle>
                </svg>
                <div class="progress-text">
                    <span class="progress-value" id="exercise-time-left">${item.duration}</span>
                    <div class="progress-label">Seconds</div>
                </div>
            </div>

            <div class="exercise-meta">
                ${detailsContent ? `<a class="details-toggle" onclick="toggleDetails()">Show Details</a>` : ''}
                ${detailsContent}
                <p id="next-exercise-text">
                    ${nextItem ? `Next: ${nextItem.name}` : ''}
                </p>
            </div>
        `;
        
        if (item.voice && isPlaying) speak(item.voice);
        updateAllUI();
    };

    // Toggle details function
    const toggleDetails = () => {
        const details = document.getElementById('exercise-details');
        const toggle = document.querySelector('.details-toggle');
        if (details && toggle) {
            if (details.classList.contains('visible')) {
                details.classList.remove('visible');
                toggle.textContent = 'Show Details';
            } else {
                details.classList.add('visible');
                toggle.textContent = 'Hide Details';
            }
        }
    };
    
    // UI Update Functions
    const updateAllUI = () => {
        if (currentExerciseIndex >= routine.length) return;
        
        const totalTime = calculateTotalTime();
        
        let timeElapsedSoFar = 0;
        for (let i = 0; i < currentExerciseIndex; i++) {
            timeElapsedSoFar += routine[i].duration;
        }
        const totalTimeElapsed = timeElapsedSoFar + timeSpentInCurrent;
        const totalTimeLeft = totalTime - totalTimeElapsed;

        // Overall Progress
        const overallPercentage = totalTime > 0 ? (totalTimeElapsed / totalTime) * 100 : 0;
        updateCircularProgress(document.getElementById('overall-progress-bar'), overallPercentage);
        document.getElementById('overall-progress-value').textContent = `${Math.round(overallPercentage)}%`;
        
        // Time Summary
        document.getElementById('total-time-spent').textContent = formatTime(totalTimeElapsed);
        document.getElementById('total-time-left').textContent = formatTime(totalTimeLeft);

        // Exercise Timer
        const currentDuration = routine[currentExerciseIndex].duration;
        const exercisePercentage = currentDuration > 0 ? (timeSpentInCurrent / currentDuration) * 100 : 0;
        updateCircularProgress(document.getElementById('exercise-progress-bar'), exercisePercentage);
        document.getElementById('exercise-time-left').textContent = Math.round(currentDuration - timeSpentInCurrent);
        
        updateControls();
    };

    const updateControls = () => {
        const isFirst = currentExerciseIndex === 0;
        const isLast = currentExerciseIndex >= routine.length - 1;
        // Enable prev if not first and routine not complete
        prevBtn.disabled = !isPlaying || isFirst || currentExerciseIndex >= routine.length;
        // Enable skip if not last and routine not complete
        skipBtn.disabled = !isPlaying || isLast || currentExerciseIndex >= routine.length;
        // Play/Pause button should be enabled unless routine is complete
        playPauseBtn.disabled = currentExerciseIndex >= routine.length;
    };
    
    // Timer Logic
    const startTimer = () => {
        if (currentExerciseIndex >= routine.length) return;
        
        const currentItem = routine[currentExerciseIndex];
        const totalDuration = currentItem.duration;
        let halfAnnounced = false;
        
        clearInterval(exerciseTimer);
        exerciseTimer = setInterval(() => {
            if (isPaused) return;

            timeSpentInCurrent++;
            updateAllUI();
            
            // Halfway announcement
            if (!halfAnnounced && totalDuration > 15 && timeSpentInCurrent >= Math.floor(totalDuration / 2)) {
                if (/Side 1/i.test(currentItem.name)) {
                    speak('Halfway there. Get ready to switch sides.');
                } else {
                   speak('Halfway there.');
                }
                halfAnnounced = true;
            }

            if (timeSpentInCurrent >= totalDuration) {
                clearInterval(exerciseTimer);
                currentExerciseIndex++;
                timeSpentInCurrent = 0;
                displayExercise(currentExerciseIndex);
                if(isPlaying) startTimer();
            }
        }, 1000);
    };

    // Control Actions
    const skipExercise = (isPrev = false) => {
        clearInterval(exerciseTimer);
        currentExerciseIndex += isPrev ? -1 : 1;
        timeSpentInCurrent = 0;
        if (currentExerciseIndex < 0) currentExerciseIndex = 0;
        if (currentExerciseIndex >= routine.length) {
            completeRoutine();
            return;
        }
        displayExercise(currentExerciseIndex);
        if (isPlaying && !isPaused) startTimer();
    };

    const previousExercise = () => skipExercise(true);

    const updatePlayPauseBtn = () => {
        const icon = document.getElementById('playPauseIcon');
        const label = document.getElementById('playPauseLabel');
        if (!isPlaying) {
            if (icon) icon.textContent = 'play_arrow';
            if (label) label.textContent = 'Play';
        } else if (isPaused) {
            if (icon) icon.textContent = 'play_arrow';
            if (label) label.textContent = 'Resume';
        } else {
            if (icon) icon.textContent = 'pause';
            if (label) label.textContent = 'Pause';
        }
    };

    const togglePlayPause = () => {
        if (!isPlaying) {
            isPlaying = true;
            isPaused = false;
            updatePlayPauseBtn();
            displayExercise(currentExerciseIndex);
            startTimer();
        } else {
            isPaused = !isPaused;
            updatePlayPauseBtn();
            if (isPaused) {
                synth.pause();
            } else {
                synth.resume();
            }
        }
        updateControls();
    };

    const completeRoutine = () => {
        isPlaying = false;
        isPaused = false;
        clearInterval(exerciseTimer);
        appView.innerHTML = `
            <div class="complete-screen">
                <h2>Routine Complete!</h2>
                <p>Great work taking care of your body. Remember to hydrate and recover well.</p>
                <button class="test-btn" id="restartBtn">Restart</button>
            </div>
        `;
        playPauseBtn.disabled = true;
        prevBtn.disabled = true;
        skipBtn.disabled = true;
        speak("Congratulations! You have completed the stretching routine. Great work!");
        // Add restart functionality
        setTimeout(() => {
            const restartBtn = document.getElementById('restartBtn');
            if (restartBtn) {
                restartBtn.onclick = function() {
                    currentExerciseIndex = 0;
                    timeSpentInCurrent = 0;
                    isPlaying = false;
                    isPaused = false;
                    playPauseBtn.disabled = false;
                    updatePlayPauseBtn();
                    displayExercise(currentExerciseIndex);
                };
            }
        }, 100);
    };
    
    // Initial Load
    document.addEventListener('DOMContentLoaded', () => {
        updatePlayPauseBtn();
        displayExercise(currentExerciseIndex);
    });
    </script>
</body>
</html>